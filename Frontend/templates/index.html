<!DOCTYPE html>
<html lang="en">
    <script>
        fetch('/me')
            .then(response => response.json())
            .then(data => {
                if (data.email) {
                    console.log(data.email)
                document.getElementById('username').textContent = `Logged in as ${data.username}`;
                }
            });

    </script>
    <head>
        <title>The New York Times - Breaking News, US News, World News, and Videos</title>
        <link rel="stylesheet" href="{{ url_for('static', filename='styles.css') }}">
        <script src="{{ url_for('static', filename='main.js') }}"></script>

    </head>
    <body>
        <header>
            <h1 id="title_logo">The New York Times</h1>
            <div id="date_section">
                <div id="date"></div>
            </div>
            <div id="user_section">
                    <h4 id = "username"></h2>
                    <a href="{{ url_for('logout') }}">Logout</a>
            </div>
        </header>
        <main>
            <hr>
            <hr>
            <div id="articles">

                <!--First article on leftmost side-->
                <section class="article1">

                    <!--Extracting attributes from very first story in stories list-->
                    <h2><a href="{{ stories[0].url }}" target="_blank">{{ stories[0].title }}</a></h2>
                    <p><strong>Published:</strong> {{ stories[0].pub_date }}</p>

                    <!--Extracting summary-->
                    <p>{{ stories[0].summary }}</p>

                    <!--Extracting image from multimedia metadata-->
                    <img src="{{ stories[0]['multimedia']['default']['url'] }}" alt="Thumbnail Image" />
                    <hr>
                    
                    <form action="{{ url_for('add_comments') }}" method="POST">
                        <input name="comment1" id="comment1" />
                        <button type="submit">Submit</button>
                    </form>

                    <section class = "comment-section1">
                        {%for comment in comments%}
                            {%if comment.comment1%}
                                <p>{{comment.comment1}}</p>
                            {%endif%}
                        {%endfor%}
                    </section>

                </section>
                
                <!--Middle article-->
                <section class="article2">

                    <!--Extracting attributes from second story in stories list-->
                    <h2><a href="{{ stories[1].url }}" target="_blank">{{ stories[1].title }}</a></h2>
                    <p><strong>Published:</strong> {{ stories[1].pub_date }}</p>

                    <!--Extracting summary-->
                    <p>{{ stories[1].summary }}</p>

                    
                    <!--Extracting image from multimedia metadata-->
                    <img src="{{ stories[1]['multimedia']['default']['url'] }}" alt="Thumbnail Image" />
                    <hr>

                    <form action="{{ url_for('add_comments') }}" method="POST">
                        <input name="comment2" id="comment2" />
                        <button type="submit">Submit</button>
                    </form>

                    <section class = "comment-section1">
                        {%for comment in comments%}
                            {%if comment.comment2%}
                                <p>{{comment.comment2}}</p>
                            {%endif%}
                        {%endfor%}
                    </section>



                </section>
                
                <!--Article on rightmost side-->
                <section class="article3">

                    <!--Extracting attributes from third story in stories list-->
                    <h2><a href="{{ stories[2].url }}" target="_blank">{{ stories[2].title }}</a></h2>
                    <p><strong>Published:</strong> {{ stories[2].pub_date }}</p>

                    <!--Extracting summary-->
                    <p>{{ stories[2].summary }}</p>

                    
                    <!--Extracting image from multimedia metadata-->
                    <img src="{{ stories[2]['multimedia']['default']['url'] }}" alt="Thumbnail Image" />
                    <hr>


                    <form action="{{ url_for('add_comments') }}" method="POST">
                        <input name="comment3" id="comment3" />
                        <button type="submit">Submit</button>
                    </form>

                    <section class = "comment-section1">
                        {%for comment in comments%}
                            {%if comment.comment3%}
                                <p>{{comment.comment3}}</p>
                            {%endif%}
                        {%endfor%}
                    </section>
                </section>
            </div>
            
        </main>


        <footer>
            <hr>
            <hr>
        </footer>
    </body>
</html>  